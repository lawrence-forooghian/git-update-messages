#!/bin/bash
set -e
# e.g. TOOL_PATH=~/code/git-update-messages
# TOOL_PATH=
COMMAND_PATH="bin/hooks/post-rewrite"

if [[ -z  "${TOOL_PATH}" ]]
then
    echo "TOOL_PATH not set." 2>&1
    exit 1
fi

REPO_PATH="$(pwd)"
# Unlike in the RVM script, we have to cd here because asdf doesn't offer a mechanism for using a .tool-versions file that's unrelated to the working directory.
cd "${TOOL_PATH}"

export BUNDLE_GEMFILE="${TOOL_PATH}/Gemfile"
asdf exec bundle exec "${TOOL_PATH}/${COMMAND_PATH}" "${REPO_PATH}" "$@"
